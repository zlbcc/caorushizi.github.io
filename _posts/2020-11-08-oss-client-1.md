---
layout: post
title: "äº‘å­˜å‚¨å®¢æˆ·ç«¯(1) åŸºç¡€ç¯å¢ƒæ­å»º"
date: 2020-11-08 23:14:00 +0800
categories: ["Github"]
tags: ["æ³°åº·æ—¥è®°"]
---


ä» 2020 å¹´åˆåˆ°ç°åœ¨å·²ç»å¼€å‘äº†å¿«ä¸€å¹´äº†ã€‚å…¶å®æˆ‘æœ€åˆæƒ³åšä¸€ä¸ªå®Œå…¨æ¨¡ä»¿ç™¾åº¦ç½‘ç›˜çš„å®¢æˆ·ç«¯ç¨‹åºï¼Œé‚£æ—¶å€™è¿˜æ˜¯ 2019 å¹´å¹´åˆçš„æ—¶å€™ï¼Œæœ€åˆå°±æ˜¯æƒ³åšä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œç”¨æ¥ä¸Šä¼ é™æ€çš„ç½‘ç«™åˆ°ä¸ƒç‰›äº‘æ–¹ä¾¿ä¸€äº›ï¼Œä»¥ä¸‹æ˜¯è½¯ä»¶çš„æˆªå›¾ã€‚

![å›¾ç‰‡](https://uploader.shimo.im/f/98xUvBe71X813r5U.png!thumbnail)

å½“æ—¶ä¹Ÿåªæ˜¯æƒ³åšä¸€åšç©ä¸€ç©ï¼ŒåŸºæœ¬åŠŸèƒ½åšå®Œä¹‹åä¹Ÿå°±æ²¡æœ‰ä»€ä¹ˆè¿›åº¦äº†ã€‚çŸ¥é“ä»Šå¹´å¹´åˆçš„æ—¶å€™æ‰æœ‰ä¸ªæƒ³æ³•æŠŠè¿™ä¸ªå®¢æˆ·ç«¯å®Œå–„ä¸€ä¸‹ã€‚ä¸‹é¢æ˜¯æ–°å‘çš„é¡µé¢æˆªå›¾ï¼š

![å›¾ç‰‡](https://uploader.shimo.im/f/aYXSTTqFizlZRGQ7.gif)![å›¾ç‰‡](https://uploader.shimo.im/f/OYeliWQZukqW9knL.gif)![å›¾ç‰‡](https://uploader.shimo.im/f/tx2jgxjCVIZTYdM0.gif)

## å¼€å‘ oss-clientï¼šåŸºç¡€ç¯å¢ƒæ­å»º

### ä½¿ç”¨ electron-forge

`electron-forge`æ˜¯ç”¨äºåˆ›å»ºï¼Œå‘å¸ƒå’Œå®‰è£…ç°ä»£`Electron`åº”ç”¨ç¨‹åºçš„å®Œæ•´å·¥å…·ï¼Œ[electron forge å®˜ç½‘](https://www.electronforge.io/)ã€‚äºŒè¯ä¸è¯´ç›´æ¥ä¸Šæ‰‹æã€‚

ä½¿ç”¨å®˜æ–¹æ¨èçš„è„šæ‰‹æ¶å·¥å…·å’Œå†…ç½®çš„æ¨¡æ¿

```shell script
npx create-electron-app oss-client --template=typescript-webpack
```
åˆå§‹åŒ–çš„è¿‡ç¨‹è¿˜æ˜¯å¾ˆæ„‰å¿«çš„ï¼Œè‡³å°‘æˆ‘åœ¨åˆå§‹åŒ–çš„æ—¶å€™æ²¡æœ‰é‡åˆ°ä»€ä¹ˆå¤§å‘ï¼Œå¦‚æœ npm é»˜è®¤çš„æºæ¯”è¾ƒæ…¢çš„è¯ï¼Œæ¨èè¿™ä¸ª[åä¸ºäº‘é•œåƒ](https://mirrors.huaweicloud.com/)ã€‚è¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„æ˜¯ Windows ä¸Šå®‰è£… node-gyp å‡ºç°é—®é¢˜çš„è¯å¯ä»¥çœ‹ä¸€ä¸‹[è¿™ç¯‡æ–‡ç« ](https://simulatedgreg.gitbooks.io/electron-vue/content/en/getting_started.html#a-note-for-windows-users)ï¼Œä¸€èˆ¬æ¥è¯´ Windows ç”µè„‘ä¸Šåªè¦å®‰è£…äº† visual studio å’Œ python2.7 çš„è¯ electron ç¯å¢ƒæ˜¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜çš„ã€‚
è¿™ä¸ªæ¡†æ¶æ˜¯å®˜æ–¹é»˜è®¤çš„ webpack + typescript é…ç½®ã€‚å¦‚æœç”µè„‘ä¸Šå®‰è£…äº† yarn çš„è¯ electronforge ä¼šé»˜è®¤ä½¿ç”¨ yarn æ¥åˆå§‹åŒ–é¡¹ç›®çš„ã€‚ä¸‹é¢æˆ‘ä»¬é»˜è®¤ä½¿ç”¨ yarn æ¥åˆ›å»ºå¼€å‘ç¯å¢ƒã€‚ä¸‹é¢æ˜¯åˆå§‹åŒ–å®Œæˆåçš„ç›®å½•ç»“æ„ã€‚

>â”‚  .eslintrc.json                      - eslint é…ç½®æ–‡ä»¶
>â”‚  .gitignore                          - git å¿½ç•¥çš„é…ç½®æ–‡ä»¶
>â”‚  package.json                        - npm é¡¹ç›®çš„é…ç½®æ–‡ä»¶
>â”‚  tsconfig.json                       - typescript é…ç½®æ–‡ä»¶
>â”‚  webpack.main.config.js			    - electron ä¸­ä¸»çº¿ç¨‹çš„ webpack é…ç½®
>â”‚  webpack.plugins.js                  - electronforge é…ç½®æ’ä»¶åˆ—è¡¨
>â”‚  webpack.renderer.config.js		    - electron æ¸²æŸ“è¿›ç¨‹çš„ webpack é…ç½®
>â”‚  webpack.rules.js                    - electronforge é…ç½®æ–‡ä»¶
>â”‚  yarn.lock                           - yarn ç‰ˆæœ¬æ¬¾æ§åˆ¶æ–‡ä»¶
>â””â”€ src                                 - æºä»£ç ç›®å½•æ–‡ä»¶
>index.css
>index.html
>index.ts
>renderer.ts

æ¥ä¸‹æ¥å¼€å§‹é…ç½® eslint + prettier

### eslint å’Œ prettier

[eslint](https://eslint.org/)ï¼š æŸ¥æ‰¾å¹¶ä¿®å¤ JavaScript ä»£ç ä¸­çš„é—®é¢˜ã€‚

[prettier](https://prettier.io/)ï¼šprettier æ˜¯ä¸€ä¸ªå›ºæ‰§å·±è§çš„ä»£ç æ ¼å¼åŒ–ç¨‹åºï¼ˆä¸çŸ¥é“è¿™ä¸ªå›ºæ‰§å·±è§çš„æ€ä¹ˆç†è§£ï¼Œåæ­£æˆ‘æ˜¯è§‰å¾—ç”¨äº†å®ƒä¹‹åä»£ç æ¼‚äº®äº†å¾ˆå¤šï¼Œå’Œå›¢é˜Ÿä¸­çš„åŒäº‹ä»£ç é£æ ¼ä¸€è‡´äº†ï¼Œä¹‹å‰éƒ½ä¸æ•¢ç¢°åŒäº‹çš„ä»£ç ğŸ˜‚ï¼‰

ç®€è€Œè¨€ä¹‹ eslint çš„è§„åˆ™å¯ä»¥é¿å…ç¨‹åºä¸­çš„ä»£ç é”™è¯¯ï¼Œè€Œ prettier å¯ä»¥è®©å›¢é˜Ÿä¹‹é—´ä»£ç é£æ ¼ä¿æŒä¸€è‡´ã€‚äºŒè¯ä¸è¯´ç›´æ¥ä¸Šæ‰‹ã€‚

æˆ‘ä»¬ä½¿ç”¨ç¤¾åŒºä¸­æœ€ä¸¥æ ¼çš„ airbnb é£æ ¼ï¼ˆåæ¥å¾ˆå¤šæ ¡éªŒè§„åˆ™æˆ‘éƒ½æ‰‹åŠ¨å»æ‰äº†ğŸ˜‚ï¼‰

npmjs å®˜ç½‘ä¸Šæœ‰ä¸¤ä¸ª airbnb çš„è§£å†³æ–¹æ¡ˆï¼šeslint-config-airbnb å’Œ eslint-config-airbnb-baseã€‚eslint-config-airbnb-base ä¸­æ²¡æœ‰å¯¹ React çš„è¯­æ³•æ ¡éªŒï¼Œå½“ç„¶æˆ‘ä»¬é€‰æ‹© eslint-config-airbnbã€‚

å¦‚æœä½ çš„ npm ç‰ˆæœ¬å¤§äº 5 å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼ˆå¦‚æœæ˜¯è‡ªå·±ç”¨çš„å¼€å‘ç¯å¢ƒè¿˜æ˜¯å»ºè®®å®‰è£…ä¸€ä¸‹æœ€æ–°ç‰ˆæœ¬çš„ node å’Œ npmï¼Œå› ä¸º prettier 2 ç‰ˆæœ¬ä¸­å·²ç»ä¸å…¼å®¹ node10 ä»¥ä¸‹çš„ç‰ˆæœ¬äº†ï¼‰

```shell script
npx install-peerdeps --dev eslint-config-airbnb
```
å¦‚æœä½ çš„ npm ç‰ˆæœ¬å°äº 5 çš„è¯ï¼Œåœ¨ linux/unix ä¸­å¯ä»¥ä½¿ç”¨
```shell script
(
 export PKG=eslint-config-airbnb;
 npm info "$PKG@latest" peerDependencies --json | command sed 's/[\{\},]//g ; s/: /@/g' | xargs npm install --save-dev "$PKG@latest"
)
```
windows ç”¨æˆ·å¯ä»¥å®‰è£…ä½¿ç”¨ install-peerdeps å‘½ä»¤è¡Œå·¥å…·
```shell script
npm install -g install-peerdeps
install-peerdeps --dev eslint-config-airbnb
```
è¯¦æƒ…è§[eslint-config-airbnb](https://www.npmjs.com/package/eslint-config-airbnb)
è¿™é‡Œæˆ‘ä»¬æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™è¿˜æ˜¯è¦æ¢ä¸€ä¸‹æº

```shell script
npx install-peerdeps --dev eslint-config-airbnb -r registry https://mirrors.huaweicloud.com/repository/npm/
```
å®‰è£…å®Œæˆä¹‹åéœ€è¦åœ¨é¡¹ç›®ä¸­`.eslintrc.json`ä¸­é…ç½®ä¸€ä¸‹

```json
{
 "env": {
  "browser": true,
  "es6": true,
  "node": true
  },
 "extends": [
  "eslint:recommended",
  "plugin:@typescript-eslint/eslint-recommended",
  "plugin:@typescript-eslint/recommended",
  "plugin:import/errors",
  "plugin:import/warnings",
  "airbnb",
  "airbnb/hooks"
  ],
 "parser": "@typescript-eslint/parser"
}
```
ç„¶åæ·»åŠ  prettier
```shell script
yarn add --dev --exact prettier
```
å¦‚æœé¡¹ç›®ä¸­æœ‰ gitignore å’Œ eslintignore é‚£ä¹ˆ prettierignore æ˜¯åŸºäºè¿™äº›æ–‡ä»¶çš„
å®‰è£… eslint-plugin-prettier å’Œ eslint-config-prettierï¼Œåœ¨`.eslintrc.json`æ–‡ä»¶ä¸­ç»§ç»­é…ç½®

```json
{
 "env": {
  "browser": true,
  "es6": true,
  "node": true
  },
 "extends": [
  "eslint:recommended",
  "plugin:@typescript-eslint/eslint-recommended",
  "plugin:@typescript-eslint/recommended",
  "plugin:import/errors",
  "plugin:import/warnings",
  "airbnb",
  "airbnb/hooks",
  "prettier"
  ],
 "plugins": [
  "prettier"
  ],
 "rules": {
  "prettier/prettier": "error"
  },
 "parser": "@typescript-eslint/parser"
}
```
è¯·åŠ¡å¿…ç¡®ä¿åœ¨ extends æ•°ç»„ä¸­ prettier åœ¨æœ€åé¢ï¼Œprettier ä¼šæŠŠå…¶ä»–é¡¹é…ç½®é‡å†™ã€‚è¯¦è§[eslint-plugin-prettier](https://github.com/prettier/eslint-plugin-prettier)ã€[eslint-config-prettier](https://github.com/prettier/eslint-config-prettier)ã€‚
æ¥ä¸‹æ¥è¦é…ç½® reactï¼Œè¦å®‰è£… react å’Œ react-dom

```shell script
yarn add react react-dom
yarn add @types/react @types/react-dom --dev
```
åœ¨ eslint ä¸­ rules é…ç½®ä¸­æ·»åŠ  "react/jsx-filename-extension": "off" æ¥å…³é—­ jsx å¯¹æ–‡ä»¶ç±»å‹çš„é™åˆ¶
ä½¿ç”¨ normalize.css æ¥è¦†ç›–æµè§ˆå™¨ä¸­çš„é»˜è®¤æ ·å¼

```shell script
yarn add normalize.css
```
å°† src ç›®å½•ä¸­çš„ renderer.ts æ”¹ä¸º renderer.tsxï¼Œå†…å®¹å¦‚ä¸‹
```jsx
import React from "react";
import reactDom from "react-dom";
import "normalize.css/normalize.css";

const App = () => {
 return <div>hello react</div>;
};

reactDom.render(<App />, document.getElementById("root"));
```
å°† src æ–‡ä»¶å¤¹ä¸‹çš„ index.html å†…å®¹æ”¹ä¸º
```html
<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>Hello World!</title>
</head>
<body>
<div id="root"></div>
</body>
</html>
```
ç„¶åè¿è¡Œ npm start çœ‹åˆ° é¡µé¢ä¸­æ˜¾ç¤º hello react å°±è¯æ˜åŸºæœ¬ç¯å¢ƒå·²ç»æ­å»ºå®Œæ¯•ï¼
